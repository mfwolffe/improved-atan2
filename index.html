<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="author" content="Matt Wolffe">
    <meta name="description" content="Better ATan2">
    <script type="module" src="MWATan2.js"></script>
    <link rel="stylesheet" type="text/css" href="mwatan2.css">
    <title>Better ATan2</title>
</head>

<body>
    <!-- TODO: 
                - Add LaTeX (or alternative, but I use LaTeX all the time) to the html to show
                   a formal piecewise definition of this version of aTan2()
                - bootstrap for responsive design
    -->

    <h1>A Better ATan2</h1>
    <p class="credit"><small>by Matt Wolffe</small></p>

    <p>
        ATan2 is simply an arctangent function modified to return an angle in any quadrant. 
        Most ATan2 calculators return angles from 
        <math display="inline" class="tml-display" style="display:block math;">
            <mrow>
              <mo form="prefix" stretchy="false">(</mo>
              <mo>−</mo>
              <mi>π</mi>
              <mo separator="true">,</mo>
              <mi>π</mi>
              <mo form="postfix" stretchy="false">]</mo>
            </mrow>
          </math>, which, in my opinion,
        is not as useful as returning an angle between 
        <math display="inline" class="tml-display" style="display:block math;">
            <mrow>
              <mo form="prefix" stretchy="false">[</mo>
              <mn>0,2</mn>
              <mi>π</mi>
              <mo form="postfix" stretchy="false">)</mo>
            </mrow>
          </math>.
    </p>
    <p>
        Most calculators are also restricted to radians, and while the conversion to another unit
        is not difficult, why not just provide the option to choose from a list of 16 units? Some standard,
        some 'obscure'!
    </p>

    <h2>Definition</h2>

    <math display="block" class="tml-display" style="display:block math;">
        <mrow>
          <mtext>aTan2</mtext>
          <mo form="prefix" stretchy="false">(</mo>
          <mi>x</mi>
          <mo separator="true">,</mo>
          <mi>y</mi>
          <mo form="postfix" stretchy="false">)</mo>
          <mo>=</mo>
          <mrow>
            <mo fence="true" form="prefix">{</mo>
            <mtable>
              <mtr>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 0em;">
                  <mrow>
                    <mrow>
                      <mi>arctan</mi>
                      <mo>⁡</mo>
                    </mrow>
                    <mo form="prefix" stretchy="false">(</mo>
                    <mfrac>
                      <mi>y</mi>
                      <mi>x</mi>
                    </mfrac>
                    <mo form="postfix" stretchy="false">)</mo>
                  </mrow>
                </mtd>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;">
                  <mrow>
                    <mi>x</mi>
                    <mo>&gt;</mo>
                    <mn>0</mn>
                    <mtext> and </mtext>
                    <mi>y</mi>
                    <mo>≥</mo>
                    <mn>0</mn>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 0em;">
                  <mrow>
                    <mrow>
                      <mspace width="0.1667em"></mspace>
                      <mi>arctan</mi>
                      <mo>⁡</mo>
                    </mrow>
                    <mo form="prefix" stretchy="false">(</mo>
                    <mfrac>
                      <mi>y</mi>
                      <mi>x</mi>
                    </mfrac>
                    <mo form="postfix" stretchy="false">)</mo>
                    <mo>+</mo>
                    <mn>2</mn>
                    <mi>π</mi>
                  </mrow>
                </mtd>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;">
                  <mrow>
                    <mi>x</mi>
                    <mo>&gt;</mo>
                    <mn>0</mn>
                    <mtext> and </mtext>
                    <mi>y</mi>
                    <mo>&lt;</mo>
                    <mn>0</mn>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 0em;">
                  <mrow>
                    <mrow>
                      <mspace width="0.1667em"></mspace>
                      <mi>arctan</mi>
                      <mo>⁡</mo>
                    </mrow>
                    <mo form="prefix" stretchy="false">(</mo>
                    <mfrac>
                      <mi>y</mi>
                      <mi>x</mi>
                    </mfrac>
                    <mo form="postfix" stretchy="false">)</mo>
                    <mo>+</mo>
                    <mi>π</mi>
                  </mrow>
                </mtd>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;">
                  <mrow>
                    <mi>x</mi>
                    <mo>&lt;</mo>
                    <mn>0</mn>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 0em;">
                  <mfrac>
                    <mi>π</mi>
                    <mn>2</mn>
                  </mfrac>
                </mtd>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;">
                  <mrow>
                    <mi>x</mi>
                    <mo>=</mo>
                    <mn>0</mn>
                    <mtext> and </mtext>
                    <mi>y</mi>
                    <mo>&gt;</mo>
                    <mn>0</mn>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 0em;">
                  <mrow>
                    <mo>−</mo>
                    <mfrac>
                      <mi>π</mi>
                      <mn>2</mn>
                    </mfrac>
                  </mrow>
                </mtd>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;">
                  <mrow>
                    <mi>x</mi>
                    <mo>=</mo>
                    <mn>0</mn>
                    <mtext> and </mtext>
                    <mi>y</mi>
                    <mo>&gt;</mo>
                    <mn>0</mn>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 0em;">
                  <mtext>undefined</mtext>
                </mtd>
                <mtd class="tml-left" style="padding:0.5ex 0em 0.5ex 1em;">
                  <mrow>
                    <mi>x</mi>
                    <mo>=</mo>
                    <mn>0</mn>
                    <mtext> and </mtext>
                    <mi>y</mi>
                    <mo>=</mo>
                    <mn>0</mn>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo fence="true" form="postfix"></mo>
          </mrow>
        </mrow>
      </math>

    <div>
        <h3><strong>Instructions</strong></h3>
        <ol>
            <li>Enter x-coordinate value</li>
            <li>Enter y-coordinate value</li>
            <li>Select a unit from the drop-down</li>
            <li>Click "Calculate!"</li>
            <li>Revel in the fact you saved however long it would have taken to find the angle manually!</li>
        </ol>
    </div>

    <hr>

    <div class="form-bckgrd">
        <form id="coords" action="">
            <div class="form-cntnt">

            <!-- fieldset & legend?? -->

            <label for="x">x-coordinate:</label>
            <!-- new addition: placeholder & regex (require numerical text)-->
            <input class="numerical" type="text" id="x" name="x" placeholder="Enter a number" pattern="^-?\d*\.?\d*" required><br>
            <label for="y">y-coordinate:</label>
            <!-- new addition: placeholder & regex regex (require numerical text)-->
            <input class="numerical" type="text" id="y" name="y" placeholder="Enter a number" pattern="^-?\d*\.?\d*" required><br>
            <label for="unit" class="form-drop">Select unit</label>
            <select name="unit" id="unit" class="form-drop" required>
                <!-- new addition: default for validation -->
                <option value="">Select an angle measure</option>

                <!-- new addition: optgroups -->
                <optgroup label="Common">
                    <option value="degrees">Degrees</option>
                    <option value="radians">Radians</option>
                    <option value="gradians">Gradians</option>
                </optgroup>

                <optgroup label="Less Common">
                    <option value="binary radians">Binary Radians</option>
                    <option value="centirads">Centirads</option>
                    <option value="millirads">Millirads</option>
                </optgroup>

                <optgroup label="Multiples of Common Angles">
                    <option value="signs">Signs</option>
                    <option value="turns">Turns</option>
                    <option value="octants">Octants</option>
                    <option value="sextants">Sextants</option>
                </optgroup>

                <optgroup label="Geographic/Astronomical">
                    <option value="centesimal minutes">Centesimal Minutes</option>
                    <option value="centesimal seconds">Centesimal Seconds</option>
                    <option value="arcminutes">Arc minutes</option>
                    <option value="arcseconds">Arc seconds</option>
                    <option value="hour angles">Hour Angles</option>
                </optgroup>

                <optgroup label='Uncommon/"Archaic"'>
                    <option value="diameter parts">Diameter Parts</option>
                </optgroup>
            </select>

            <br>

            <input id="calc" type="submit" value="Calculate!" class="form-button">
            <!-- new addition: reset input button -->
            <input type="reset" value="Clear Input" class="form-button">

             <br>
            
            <!-- new addition: change how the result is written to the document; option to append or overwrite -->
             <fieldset>
                <legend>Retain Previous Outputs?</legend>

                <input type="radio" id="retain" name="outputChoice" checked>
                <label for="retain">Retain</label>

                <input type="radio" id="overwrite" name="outputChoice" checked>
                <label for="overwrite">Overwrite</label>

             </fieldset>

        </div>
        </form>
    </div>

    <!-- new addition: focus changes color -->
    <script>
        function bckgrd(e) {
            if (e.type == "focus") {
                e.target.style.backgroundColor = "#FFE393";
            }
            else if (e.type == "blur") {
                e.target.style.backgroundColor = "#FFFFFF";
            }
        }

        window.addEventListener("load", function() {
            const cssSelector = "input[type=text]";
            const fields = document.querySelectorAll(cssSelector);

            for (let f of fields) {
                f.addEventListener("focus", bckgrd);
                f.addEventListener("blur", bckgrd);
            }
        });
    </script>

    <div id="results">

    </div>

</body>
</html>